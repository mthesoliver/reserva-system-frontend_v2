<ion-toolbar>
</ion-toolbar>

<ion-content [fullscreen]="true">
<section class="container">
  <app-owner-info
  [currentUserInfoEmail]="currentUserInfoEmail"
  [currentUserInfoName]="currentUserInfoName"
  [currentUserInfoPhone]="currentUserInfoPhone"
  ></app-owner-info>

  <ion-row class="services-calendar-container" id="service-row">
    <!-- <ion-col size-lg="4" size-md="3.5" size="auto" class="form-col">
      <ion-title color="primary">Definições</ion-title>
      <ion-title class="ion-padding-top">{{newService.nomeServico}}</ion-title>
      <form [formGroup]="serviceUpdateForm" novalidate method="POST">
        <ion-row>
        <span class="input-title">Nome do serviço:</span>
        <ion-input fill="outline" type="text" placeholder="Digite um nome para o serviço" formControlName="nome" [(ngModel)]="newService.nomeServico"></ion-input>
      </ion-row>

        <ion-row>
          <span class="input-title">Dias da semana disponíveis para reserva:</span>
          <ion-col size="auto" class="days-list">
            <ion-checkbox labelPlacement="end" alias="0" value="0" (click)="activeCheckbox($event.target)">Domingo</ion-checkbox>
            <ion-checkbox labelPlacement="end" alias="1" value="1" (click)="activeCheckbox($event.target)">Segunda</ion-checkbox>
            <ion-checkbox labelPlacement="end" alias="2" value="2" (click)="activeCheckbox($event.target)">Terça</ion-checkbox>
            <ion-checkbox labelPlacement="end" alias="3" value="3" (click)="activeCheckbox($event.target)">Quarta</ion-checkbox>
          </ion-col>

          <ion-col size="auto" class="days-list">
            <ion-checkbox labelPlacement="end" alias="4" value="4" (click)="activeCheckbox($event.target)">Quinta</ion-checkbox>
            <ion-checkbox labelPlacement="end" alias="5" value="5" (click)="activeCheckbox($event.target)">Sexta</ion-checkbox>
            <ion-checkbox labelPlacement="end" alias="6" value="6" (click)="activeCheckbox($event.target)">Sábado</ion-checkbox>
          </ion-col>
        </ion-row>

        <ion-row>
          <span class="input-title">Horário de atendimento:</span>
          <br>
            <ion-input type="time" class="time-select" fill="outline" label="Das:" 
            labelPlacement="floating" formControlName="startTime"  [(ngModel)]="newService.horarioInicio" value="{{newService['startTime']}}">
        </ion-input>
            <ion-input type="time" class="time-select" fill="outline" label="Até as:" 
            labelPlacement="floating" formControlName="endTime" [(ngModel)]="newService.horarioFinal" value="{{newService['endTime']}}">
          </ion-input>
        </ion-row>

        <ion-row class="ion-padding-top">
          <ion-button type="submit" (click)="onSubmit()" [disabled]="!serviceUpdateForm.valid" >Adicionar serviço</ion-button>
        </ion-row>
      </form>
    </ion-col> -->

    <ion-col size-lg="4" size-md="3.5" size="auto" class="form-col" *ngIf="!isNext" [ngClass]="{animation:true}">
      <ion-title color="primary">Informações da reserva</ion-title>
      <ion-row>
        <h2 class="ion-padding-top">{{serviceName}}</h2>
      </ion-row>
      <ion-row>
        <ion-list>
        <p class="reservation-preview">Dia: <strong>{{newReservation.day}}</strong></p>
        <p class="reservation-preview">Data: <strong>{{newReservation.date}}</strong></p>
        <p class="reservation-preview">Das: <strong>{{newReservation.startTime}}</strong></p>
        <p class="reservation-preview">Até as: <strong>{{newReservation.endTime}}</strong></p>
        </ion-list>
      </ion-row>
    </ion-col>

    <ion-col size-lg="5" size-md="5" size="auto" class="calendar-col" [ngClass]="triggerClass()">
      <ion-toolbar>
        <ion-nav>
          <ion-title style="text-transform: capitalize;" color="primary" class="ion-text-center">{{viewTitle}}</ion-title>
          <ion-buttons class="ion-justify-content-between">
            <ion-button (click)="calendarBack()"><ion-icon name="chevron-back-outline"></ion-icon>Anterior</ion-button>
            <ion-button [disabled]="isToday" (click)="today()">Hoje</ion-button>
            <ion-button (click)="calendarForward()">Próximo<ion-icon name="chevron-forward-outline"></ion-icon></ion-button>
          </ion-buttons>
        </ion-nav>
      </ion-toolbar>
      <calendar class="services-calendar-details" 
      [calendarMode]="calendar.mode"
        [currentDate]="calendar.currentDate" 
        [markDisabled]="markDisabled" [timeInterval]="30" 
        [endHour]="setEndHour"
        [startHour]="setStartHour" 
        noEventsLabel="Sem reservas para esta data"
        (onCurrentDateChanged)="onCurrentDateChanged($event)" 
        allDayLabel=""
        (onEventSelected)="onEventSelected($event)"
        (onTitleChanged)="onViewTitleChanged($event)"
        (onTimeSelected)="onTimeSelected($event)" 
        [step]="calendar.step">
      </calendar>
    </ion-col>

    <ion-col size-lg="3" size-md="3.5" size="auto" class="time-col" *ngIf="!isNext" [ngClass]="{animation:true}" >
      <ion-title color="primary">Horários disponíveis</ion-title>
      <ion-segment>
        <ion-list style="display: flex; flex-direction: column;">
          <ion-button 
          (click)="selectHour($event)"
          fill="outline" *ngFor="let horas of horariosDisponiveis" class="hours-item">{{horas}}
        </ion-button>
        </ion-list>
      </ion-segment>
    </ion-col>

    <ion-col size-lg="6" size-md="6" size="auto" class="form-col ion-padding-start ion-margin-start" *ngIf="isNext" [ngClass]="triggerForm()">
      <ion-title color="primary">Confirmação da reserva</ion-title>
      <ion-row>
        <h2 class="ion-padding-top">{{serviceName}}</h2>
      </ion-row>
      <ion-row>
        <ion-col>
          <ion-list>
            <p class="reservation-preview">Dia: <strong>{{newReservation.day}}</strong></p>
            <p class="reservation-preview">Data: <strong>{{newReservation.date}}</strong></p>
            </ion-list>
        </ion-col>
        <ion-col>
          <ion-list>
            <p class="reservation-preview">Das: <strong>{{newReservation.startTime}}</strong></p>
            <p class="reservation-preview">Até as: <strong>{{newReservation.endTime}}</strong></p>
            </ion-list>
        </ion-col>

        <form [formGroup]="newReservationForm" novalidate method="POST" class="reservation-form">
          <ion-row>
          <span class="input-title">Seu nome:</span>
          <ion-input fill="outline" type="text" placeholder="Digite seu nome" formControlName="nome" [(ngModel)]="reservationUser.name" clear-input="true" autocomplete="name" size="sm"></ion-input>

          <span class="input-title">Seu telefone:</span>
          <ion-input fill="outline" type="tel" placeholder="Digite seu telefone" formControlName="phone" [(ngModel)]="reservationUser.phone"  [maskito]="phoneMask"
          [maskitoElement]="maskPredicate" clear-input="true" autocomplete="tel-national"></ion-input>

          <span class="input-title">Seu melhor email:</span>
          <ion-input fill="outline" type="email" placeholder="Digite seu melhor email" formControlName="email" [(ngModel)]="reservationUser.email"  clear-input="true" autocomplete="email">
            <span *ngIf="newReservationForm.controls.email.hasError('required')" slot="end" class="error-log">Email é obrigatório</span>
            <span *ngIf="newReservationForm.controls.email.hasError('email')" slot="end" class="error-log">Digite um email válido</span>
            <span *ngIf="newReservationForm.controls.email.hasError('emailAlreadyExists')" slot="end" class="error-log">Email já cadastrado</span></ion-input>
          
          <ion-button type="submit" fill="solid" color="primary"  class="ion-padding-vertical btn-submit" [disabled]="!newReservationForm.valid" (click)="onSubmit()">Confirmar reserva!</ion-button>

        </ion-row>
        </form>
      
      </ion-row>
    </ion-col>

    <ion-row style="width: 100%;" class="ion-padding-top" *ngIf="isAllChecks">
      <ion-toolbar>
        <ion-buttons slot="start" *ngIf="isNext">
        <ion-button fill="outline" color="secondary" size="large" class="confirm-button" (click)="returnToReservation()"> Voltar</ion-button>
      </ion-buttons>
        <ion-buttons slot="end">
          <ion-button fill="solid" color="secondary" size="large" class="confirm-button" (click)="goToConfirm()"> Avançar</ion-button>
        </ion-buttons>
    </ion-toolbar>
    </ion-row>
  
  </ion-row>

</section>
</ion-content>

